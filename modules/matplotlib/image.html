

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>matplotlib.image &mdash; PROJECT_NAME 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PROJECT_NAME 1 documentation" href="../../index.html"/>
        <link rel="up" title="matplotlib" href="../matplotlib.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PROJECT_NAME
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.html">1. matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.pyplot.html">2. matplotlib.pyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.axes.html">3. matplotlib.axes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.axis.html">4. matplotlib.axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.cm.html">5. matplotlib.cm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.colorbar.html">6. matplotlib.colorbar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.colors.html">7. matplotlib.colors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.figure.html">8. matplotlib.figure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.legend.html">9. matplotlib.legend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.lines.html">10. matplotlib.lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.markers.html">11. matplotlib.markers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.patches.html">12. matplotlib.patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.style.html">13. matplotlib.style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.text.html">14. matplotlib.text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.widgets.html">15. matplotlib.widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../separator.html">16. ===== INFREQ =====</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.animation.html">17. matplotlib.animation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.artist.html">18. matplotlib.artist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.backends.html">19. matplotlib.backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.cbook.html">20. matplotlib.cbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.collections.html">21. matplotlib.collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.dates.html">22. matplotlib.dates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.dviread.html">23. matplotlib.dviread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.finance.html">24. matplotlib.finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.font_manager.html">25. matplotlib.font_manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.gridspec.html">26. matplotlib.gridspec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.image.html">27. matplotlib.image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.mathtext.html">28. matplotlib.mathtext</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.mlab.html">29. matplotlib.mlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.offsetbox.html">30. matplotlib.offsetbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.path.html">31. matplotlib.path</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.patheffects.html">32. matplotlib.patheffects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.sankey.html">33. matplotlib.sankey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.spines.html">34. matplotlib.spines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.ticker.html">35. matplotlib.ticker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.tight_layout.html">36. matplotlib.tight_layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.tri.html">37. matplotlib.tri</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.type1font.html">38. matplotlib.type1font</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generated/matplotlib.units.html">39. matplotlib.units</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PROJECT_NAME</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../matplotlib.html">matplotlib</a> &raquo;</li>
        
      <li>matplotlib.image</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for matplotlib.image</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The image module supports basic image loading, rescaling and display</span>
<span class="sd">operations.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib.externals</span> <span class="k">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">matplotlib.externals.six.moves.urllib.parse</span> <span class="k">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">matplotlib.externals.six.moves.urllib.request</span> <span class="k">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">BytesIO</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">matplotlib.artist</span> <span class="k">as</span> <span class="nn">martist</span>
<span class="kn">from</span> <span class="nn">matplotlib.artist</span> <span class="k">import</span> <span class="n">allow_rasterization</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.cbook</span> <span class="k">as</span> <span class="nn">cbook</span>

<span class="c1"># For clarity, names from _image are given explicitly in this module:</span>
<span class="kn">import</span> <span class="nn">matplotlib._image</span> <span class="k">as</span> <span class="nn">_image</span>
<span class="kn">import</span> <span class="nn">matplotlib._png</span> <span class="k">as</span> <span class="nn">_png</span>

<span class="c1"># For user convenience, the names from _image are also imported into</span>
<span class="c1"># the image namespace:</span>
<span class="kn">from</span> <span class="nn">matplotlib._image</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="k">import</span> <span class="n">BboxBase</span><span class="p">,</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">IdentityTransform</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="k">as</span> <span class="nn">mtransforms</span>

<span class="c1"># map interpolation strings to module constants</span>
<span class="n">_interpd_</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">,</span>  <span class="c1"># fall back to nearest when not supported</span>
    <span class="s1">&#39;nearest&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">,</span>
    <span class="s1">&#39;bilinear&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
    <span class="s1">&#39;bicubic&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">BICUBIC</span><span class="p">,</span>
    <span class="s1">&#39;spline16&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">SPLINE16</span><span class="p">,</span>
    <span class="s1">&#39;spline36&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">SPLINE36</span><span class="p">,</span>
    <span class="s1">&#39;hanning&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">HANNING</span><span class="p">,</span>
    <span class="s1">&#39;hamming&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">HAMMING</span><span class="p">,</span>
    <span class="s1">&#39;hermite&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">HERMITE</span><span class="p">,</span>
    <span class="s1">&#39;kaiser&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">KAISER</span><span class="p">,</span>
    <span class="s1">&#39;quadric&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">QUADRIC</span><span class="p">,</span>
    <span class="s1">&#39;catrom&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">CATROM</span><span class="p">,</span>
    <span class="s1">&#39;gaussian&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">GAUSSIAN</span><span class="p">,</span>
    <span class="s1">&#39;bessel&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">BESSEL</span><span class="p">,</span>
    <span class="s1">&#39;mitchell&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">MITCHELL</span><span class="p">,</span>
    <span class="s1">&#39;sinc&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">SINC</span><span class="p">,</span>
    <span class="s1">&#39;lanczos&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">,</span>
    <span class="s1">&#39;blackman&#39;</span><span class="p">:</span> <span class="n">_image</span><span class="o">.</span><span class="n">BLACKMAN</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">interpolations_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">_interpd_</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_AxesImageBase</span><span class="p">(</span><span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">):</span>
    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># the 3 following keys seem to be unused now, keep it for</span>
    <span class="c1"># backward compatibility just in case.</span>
    <span class="n">_interpd</span> <span class="o">=</span> <span class="n">_interpd_</span>
    <span class="c1"># reverse interp dict</span>
    <span class="n">_interpdr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">_interpd_</span><span class="p">)])</span>
    <span class="n">iterpnames</span> <span class="o">=</span> <span class="n">interpolations_names</span>
    <span class="c1"># &lt;end unused keys&gt;</span>

    <span class="k">def</span> <span class="nf">set_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_AxesImageBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">set_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_AxesImageBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_norm</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;AxesImage(</span><span class="si">%g</span><span class="s2">,</span><span class="si">%g</span><span class="s2">;</span><span class="si">%g</span><span class="s2">x</span><span class="si">%g</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">filternorm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">filterrad</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                 <span class="n">resample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        interpolation and cmap default to their rc settings</span>

<span class="sd">        cmap is a colors.Colormap instance</span>
<span class="sd">        norm is a colors.Normalize instance to map luminance to 0-1</span>

<span class="sd">        extent is data axes (left, right, bottom, top) for making image plots</span>
<span class="sd">        registered with data plots.  Default is to label the pixel</span>
<span class="sd">        centers with the zero-based row and column indices.</span>

<span class="sd">        Additional kwargs are matplotlib.artist properties</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mouseover</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.origin&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_filternorm</span><span class="p">(</span><span class="n">filternorm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_filterrad</span><span class="p">(</span><span class="n">filterrad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span> <span class="o">=</span> <span class="n">filterrad</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="n">interpolation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_resample</span><span class="p">(</span><span class="n">resample</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">ax</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># this is an experimental attribute, if True, unsampled image</span>
        <span class="c1"># will be drawn using the affine transform that are</span>
        <span class="c1"># appropriately skewed so that the given position</span>
        <span class="c1"># corresponds to the actual position in the coordinate. -JJL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image_skew_coordinate</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">_AxesImageBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
        <span class="c1"># We can&#39;t pickle the C Image cached object.</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_imcache&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the numrows, numcols of the input image&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the alpha value used for blending - not supported on</span>
<span class="sd">        all backends</span>

<span class="sd">        ACCEPTS: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call this whenever the mappable is changed so observers can</span>
<span class="sd">        update state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The make_image method must be overridden.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">image_extents</span><span class="p">,</span> <span class="n">viewlim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        convert numpy array A with given extents ([x1, x2, y1, y2] in</span>
<span class="sd">        data coordinate) into the Image, given the viewlim (should be a</span>
<span class="sd">        bbox instance).  Image will be clipped if the extents is</span>
<span class="sd">        significantly larger than the viewlim.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">image_extents</span>
        <span class="n">dxintv</span> <span class="o">=</span> <span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span>
        <span class="n">dyintv</span> <span class="o">=</span> <span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span>

        <span class="c1"># the viewport scale factor</span>
        <span class="k">if</span> <span class="n">viewlim</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">dxintv</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="n">dxintv</span><span class="o">/</span><span class="n">viewlim</span><span class="o">.</span><span class="n">width</span>
        <span class="k">if</span> <span class="n">viewlim</span><span class="o">.</span><span class="n">height</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">dyintv</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sy</span> <span class="o">=</span> <span class="n">dyintv</span><span class="o">/</span><span class="n">viewlim</span><span class="o">.</span><span class="n">height</span>
        <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sx</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewlim</span><span class="o">.</span><span class="n">x0</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">dxintv</span> <span class="o">*</span> <span class="n">numcols</span>
            <span class="n">ix0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">))</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewlim</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">dxintv</span> <span class="o">*</span> <span class="n">numcols</span>
            <span class="n">ix1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">numcols</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">))</span>
            <span class="n">xslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">ix0</span><span class="p">,</span> <span class="n">ix1</span><span class="p">)</span>
            <span class="n">xmin_old</span> <span class="o">=</span> <span class="n">xmin</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin_old</span> <span class="o">+</span> <span class="n">ix0</span><span class="o">*</span><span class="n">dxintv</span><span class="o">/</span><span class="n">numcols</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmin_old</span> <span class="o">+</span> <span class="n">ix1</span><span class="o">*</span><span class="n">dxintv</span><span class="o">/</span><span class="n">numcols</span>
            <span class="n">dxintv</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="n">dxintv</span><span class="o">/</span><span class="n">viewlim</span><span class="o">.</span><span class="n">width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numcols</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sy</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewlim</span><span class="o">.</span><span class="n">y0</span><span class="o">-</span><span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="n">dyintv</span> <span class="o">*</span> <span class="n">numrows</span>
            <span class="n">iy0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">))</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">viewlim</span><span class="o">.</span><span class="n">y1</span><span class="o">-</span><span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="n">dyintv</span> <span class="o">*</span> <span class="n">numrows</span>
            <span class="n">iy1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">))</span>
            <span class="n">yslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">iy0</span><span class="p">,</span> <span class="n">iy1</span><span class="p">)</span>
            <span class="n">ymin_old</span> <span class="o">=</span> <span class="n">ymin</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin_old</span> <span class="o">+</span> <span class="n">iy0</span><span class="o">*</span><span class="n">dyintv</span><span class="o">/</span><span class="n">numrows</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymin_old</span> <span class="o">+</span> <span class="n">iy1</span><span class="o">*</span><span class="n">dyintv</span><span class="o">/</span><span class="n">numrows</span>
            <span class="n">dyintv</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>
            <span class="n">sy</span> <span class="o">=</span> <span class="n">dyintv</span><span class="o">/</span><span class="n">viewlim</span><span class="o">.</span><span class="n">height</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numrows</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xslice</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldxslice</span> <span class="ow">or</span> <span class="n">yslice</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldyslice</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_oldxslice</span> <span class="o">=</span> <span class="n">xslice</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_oldyslice</span> <span class="o">=</span> <span class="n">yslice</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span> <span class="ow">and</span> <span class="n">A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">frombyte</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">,</span> <span class="p">:],</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="c1"># Avoid side effects: to_rgba can return its argument</span>
                    <span class="c1"># unchanged.</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="c1"># premultiply the colors</span>
                    <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="n">x</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">frombyte</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">,</span> <span class="p">:],</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_gray</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="n">im</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span>

        <span class="k">return</span> <span class="n">im</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">dxintv</span><span class="p">,</span> <span class="n">dyintv</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_rotate_and_skew_transform</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retuen a transform that does</span>
<span class="sd">         (x1, y1) -&gt; (x1, y1)</span>
<span class="sd">         (x2, y2) -&gt; (x2, y2)</span>
<span class="sd">         (x2, y1) -&gt; (x3, y3)</span>

<span class="sd">        It was intended to derive a skew transform that preserve the</span>
<span class="sd">        lower-left corner (x1, y1) and top-right corner(x2,y2), but</span>
<span class="sd">        change the lower-right-corner(x2, y1) to a new position</span>
<span class="sd">        (x3, y3).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tr1</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>
        <span class="n">tr1</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">y1</span><span class="p">)</span>
        <span class="n">x2a</span><span class="p">,</span> <span class="n">y2a</span> <span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
        <span class="n">x3a</span><span class="p">,</span> <span class="n">y3a</span> <span class="o">=</span> <span class="n">tr1</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">))</span>

        <span class="n">inv_mat</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2a</span><span class="o">*</span><span class="n">y3a</span><span class="o">-</span><span class="n">y2a</span><span class="o">*</span><span class="n">x3a</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">([[</span><span class="n">y3a</span><span class="p">,</span> <span class="o">-</span><span class="n">y2a</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">x3a</span><span class="p">,</span> <span class="n">x2a</span><span class="p">]])</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">inv_mat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">([[</span><span class="n">x2a</span><span class="p">],</span> <span class="p">[</span><span class="n">x2a</span><span class="p">]]))</span><span class="o">.</span><span class="n">flat</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">inv_mat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">([[</span><span class="n">y2a</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]))</span><span class="o">.</span><span class="n">flat</span>

        <span class="n">tr2</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">tr</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr1</span> <span class="o">+</span> <span class="n">tr2</span> <span class="o">+</span>
              <span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">get_affine</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">tr</span>

    <span class="k">def</span> <span class="nf">_draw_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">gc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        draw unsampled image. The renderer should support a draw_image method</span>
<span class="sd">        with scale parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>  <span class="c1"># axes.transData</span>

        <span class="c1"># convert the coordinates to the intermediate coordinate (ic).</span>
        <span class="c1"># The transformation from the ic to the canvas is a pure</span>
        <span class="c1"># affine transform.</span>

        <span class="c1"># A straight-forward way is to use the non-affine part of the</span>
        <span class="c1"># original transform for conversion to the ic.</span>

        <span class="c1"># firs, convert the image extent to the ic</span>
        <span class="n">x_llc</span><span class="p">,</span> <span class="n">x_trc</span><span class="p">,</span> <span class="n">y_llc</span><span class="p">,</span> <span class="n">y_trc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>

        <span class="n">xy</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">x_llc</span><span class="p">,</span> <span class="n">y_llc</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">x_trc</span><span class="p">,</span> <span class="n">y_trc</span><span class="p">)]))</span>

        <span class="n">_xx1</span><span class="p">,</span> <span class="n">_yy1</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">_xx2</span><span class="p">,</span> <span class="n">_yy2</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">extent_in_ic</span> <span class="o">=</span> <span class="n">_xx1</span><span class="p">,</span> <span class="n">_xx2</span><span class="p">,</span> <span class="n">_yy1</span><span class="p">,</span> <span class="n">_yy2</span>

        <span class="c1"># define trans_ic_to_canvas : unless _image_skew_coordinate is</span>
        <span class="c1"># set, it is simply a affine part of the original transform.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image_skew_coordinate</span><span class="p">:</span>
            <span class="c1"># skew the image when required.</span>
            <span class="n">x_lrc</span><span class="p">,</span> <span class="n">y_lrc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image_skew_coordinate</span>
            <span class="n">xy2</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">x_lrc</span><span class="p">,</span> <span class="n">y_lrc</span><span class="p">)]))</span>
            <span class="n">_xx3</span><span class="p">,</span> <span class="n">_yy3</span> <span class="o">=</span> <span class="n">xy2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">tr_rotate_skew</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotate_and_skew_transform</span><span class="p">(</span><span class="n">_xx1</span><span class="p">,</span> <span class="n">_yy1</span><span class="p">,</span>
                                                                 <span class="n">_xx2</span><span class="p">,</span> <span class="n">_yy2</span><span class="p">,</span>
                                                                 <span class="n">_xx3</span><span class="p">,</span> <span class="n">_yy3</span><span class="p">)</span>
            <span class="n">trans_ic_to_canvas</span> <span class="o">=</span> <span class="n">tr_rotate_skew</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">trans_ic_to_canvas</span> <span class="o">=</span> <span class="n">IdentityTransform</span><span class="p">()</span>

        <span class="c1"># Now, viewLim in the ic.  It can be rotated and can be</span>
        <span class="c1"># skewed. Make it big enough.</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">trans_canvas_to_ic</span> <span class="o">=</span> <span class="n">trans_ic_to_canvas</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
        <span class="n">xy_</span> <span class="o">=</span> <span class="n">trans_canvas_to_ic</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                                                     <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                                                     <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span>
                                                     <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]))</span>
        <span class="n">x1_</span><span class="p">,</span> <span class="n">x2_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xy_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xy_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">y1_</span><span class="p">,</span> <span class="n">y2_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xy_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xy_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">viewLim_in_ic</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_extents</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span> <span class="n">y1_</span><span class="p">,</span> <span class="n">x2_</span><span class="p">,</span> <span class="n">y2_</span><span class="p">)</span>

        <span class="c1"># get the image, sliced if necessary. This is done in the ic.</span>
        <span class="n">im</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">dxintv</span><span class="p">,</span> <span class="n">dyintv</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="p">,</span> <span class="n">extent_in_ic</span><span class="p">,</span> <span class="n">viewLim_in_ic</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># I&#39;m not if this check is required. -JJL</span>

        <span class="n">fc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_bg</span><span class="p">(</span><span class="o">*</span><span class="n">bg</span><span class="p">)</span>

        <span class="c1"># image input dimensions</span>
        <span class="n">im</span><span class="o">.</span><span class="n">reset_matrix</span><span class="p">()</span>
        <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">numrows</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">numcols</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">numcols</span><span class="p">,</span> <span class="n">numrows</span><span class="p">)</span>  <span class="c1"># just to create im.bufOut that</span>
                                     <span class="c1"># is required by backends. There</span>
                                     <span class="c1"># may be better solution -JJL</span>

        <span class="n">im</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">()</span>
        <span class="n">im</span><span class="o">.</span><span class="n">_gid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">()</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">draw_image</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">dxintv</span><span class="p">,</span> <span class="n">dyintv</span><span class="p">,</span>
                            <span class="n">trans_ic_to_canvas</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return True if the image is better to be drawn unsampled.</span>
<span class="sd">        The derived class needs to override it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xscale</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;linear&#39;</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yscale</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;linear&#39;</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Images are not supported on non-linear axes.&quot;</span><span class="p">)</span>

        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">widthDisplay</span><span class="p">,</span> <span class="n">heightDisplay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_gc_clip</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_unsampled_image</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_unsampled_image</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">gc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image_skew_coordinate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Image will not be shown&quot;</span>
                              <span class="s2">&quot; correctly with this backend.&quot;</span><span class="p">)</span>

            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">renderer</span><span class="o">.</span><span class="n">get_image_magnification</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">im</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">()</span>
            <span class="n">im</span><span class="o">.</span><span class="n">_gid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">()</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">draw_image</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test whether the mouse event occured within the image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">)</span>
        <span class="c1"># TODO: make sure this is consistent with patch and patch</span>
        <span class="c1"># collection on nonlinear transformed coordinates.</span>
        <span class="c1"># TODO: consider returning image coordinates (shouldn&#39;t</span>
        <span class="c1"># be too difficult given that the image is rectilinear</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xmin</span> <span class="o">&gt;</span> <span class="n">xmax</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xmin</span>
        <span class="k">if</span> <span class="n">ymin</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xmax</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ymax</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">write_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">noscale</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the image to png file with fname&quot;&quot;&quot;</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">noscale</span><span class="p">:</span>
            <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
            <span class="n">im</span><span class="o">.</span><span class="n">reset_matrix</span><span class="p">()</span>
            <span class="n">im</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">numcols</span><span class="p">,</span> <span class="n">numrows</span><span class="p">)</span>
        <span class="n">_png</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the image array</span>

<span class="sd">        ACCEPTS: numpy/PIL Image A</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if data is PIL Image without importing Image</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;getpixel&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">pil_to_array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">safe_masked_invalid</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Image data can not convert to float&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid dimensions for image data&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldxslice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldyslice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">set_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retained for backwards compatibility - use set_data instead</span>

<span class="sd">        ACCEPTS: numpy array A or PIL Image&quot;&quot;&quot;</span>
        <span class="c1"># This also needs to be here to override the inherited</span>
        <span class="c1"># cm.ScalarMappable.set_array method so it is not invoked</span>
        <span class="c1"># by mistake.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the interpolation method the image uses when resizing.</span>

<span class="sd">        One of &#39;nearest&#39;, &#39;bilinear&#39;, &#39;bicubic&#39;, &#39;spline16&#39;, &#39;spline36&#39;,</span>
<span class="sd">        &#39;hanning&#39;, &#39;hamming&#39;, &#39;hermite&#39;, &#39;kaiser&#39;, &#39;quadric&#39;, &#39;catrom&#39;,</span>
<span class="sd">        &#39;gaussian&#39;, &#39;bessel&#39;, &#39;mitchell&#39;, &#39;sinc&#39;, &#39;lanczos&#39;, or &#39;none&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span>

    <span class="k">def</span> <span class="nf">set_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the interpolation method the image uses when resizing.</span>

<span class="sd">        if None, use a value from rc setting. If &#39;none&#39;, the image is</span>
<span class="sd">        shown as is without interpolating. &#39;none&#39; is only supported in</span>
<span class="sd">        agg, ps and pdf backends and will fall back to &#39;nearest&#39; mode</span>
<span class="sd">        for other backends.</span>

<span class="sd">        ACCEPTS: [&#39;nearest&#39; | &#39;bilinear&#39; | &#39;bicubic&#39; | &#39;spline16&#39; |</span>
<span class="sd">          &#39;spline36&#39; | &#39;hanning&#39; | &#39;hamming&#39; | &#39;hermite&#39; | &#39;kaiser&#39; |</span>
<span class="sd">          &#39;quadric&#39; | &#39;catrom&#39; | &#39;gaussian&#39; | &#39;bessel&#39; | &#39;mitchell&#39; |</span>
<span class="sd">          &#39;sinc&#39; | &#39;lanczos&#39; | &#39;none&#39; |]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.interpolation&#39;</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_interpd_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Illegal interpolation string&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span> <span class="o">=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">set_resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether or not image resampling is used</span>

<span class="sd">        ACCEPTS: True|False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.resample&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resample</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_resample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the image resample boolean&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample</span>

    <span class="k">def</span> <span class="nf">set_filternorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filternorm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether the resize filter norms the weights -- see</span>
<span class="sd">        help for imshow</span>

<span class="sd">        ACCEPTS: 0 or 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filternorm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filternorm</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filternorm</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_filternorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the filternorm setting&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filternorm</span>

    <span class="k">def</span> <span class="nf">set_filterrad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filterrad</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the resize filter radius only applicable to some</span>
<span class="sd">        interpolation schemes -- see help for imshow</span>

<span class="sd">        ACCEPTS: positive float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">filterrad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The filter radius must be a positive number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span> <span class="o">=</span> <span class="n">r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_filterrad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the filterrad setting&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span>


<div class="viewcode-block" id="AxesImage"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.html#matplotlib.figure.AxesImage">[docs]</a><span class="k">class</span> <span class="nc">AxesImage</span><span class="p">(</span><span class="n">_AxesImageBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;AxesImage(</span><span class="si">%g</span><span class="s2">,</span><span class="si">%g</span><span class="s2">;</span><span class="si">%g</span><span class="s2">x</span><span class="si">%g</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>

<div class="viewcode-block" id="AxesImage.__init__"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.__init__.html#matplotlib.figure.AxesImage.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">filternorm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">filterrad</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                 <span class="n">resample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        interpolation and cmap default to their rc settings</span>

<span class="sd">        cmap is a colors.Colormap instance</span>
<span class="sd">        norm is a colors.Normalize instance to map luminance to 0-1</span>

<span class="sd">        extent is data axes (left, right, bottom, top) for making image plots</span>
<span class="sd">        registered with data plots.  Default is to label the pixel</span>
<span class="sd">        centers with the zero-based row and column indices.</span>

<span class="sd">        Additional kwargs are matplotlib.artist properties</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="o">=</span> <span class="n">extent</span>

        <span class="n">_AxesImageBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
                                <span class="n">filternorm</span><span class="o">=</span><span class="n">filternorm</span><span class="p">,</span>
                                <span class="n">filterrad</span><span class="o">=</span><span class="n">filterrad</span><span class="p">,</span>
                                <span class="n">resample</span><span class="o">=</span><span class="n">resample</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwargs</span>
                                <span class="p">)</span></div>

<div class="viewcode-block" id="AxesImage.get_window_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.get_window_extent.html#matplotlib.figure.AxesImage.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_extents</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">bbox</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span></div>

<div class="viewcode-block" id="AxesImage.make_image"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.make_image.html#matplotlib.figure.AxesImage.make_image">[docs]</a>    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image&#39;</span>
                               <span class="s1">&#39; array or the image attribute&#39;</span><span class="p">)</span>

        <span class="c1"># image is created in the canvas coordinate.</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span>
                                       <span class="p">]))</span>
        <span class="n">_x1</span><span class="p">,</span> <span class="n">_y1</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">_x2</span><span class="p">,</span> <span class="n">_y2</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">transformed_viewLim</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">TransformedBbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">viewLim</span><span class="p">,</span>
                                                          <span class="n">trans</span><span class="p">)</span>

        <span class="n">im</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">dxintv</span><span class="p">,</span> <span class="n">dyintv</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="p">,</span> <span class="p">[</span><span class="n">_x1</span><span class="p">,</span> <span class="n">_x2</span><span class="p">,</span> <span class="n">_y1</span><span class="p">,</span> <span class="n">_y2</span><span class="p">],</span>
                                      <span class="n">transformed_viewLim</span><span class="p">)</span>

        <span class="n">fc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_bg</span><span class="p">(</span><span class="o">*</span><span class="n">bg</span><span class="p">)</span>

        <span class="c1"># image input dimensions</span>
        <span class="n">im</span><span class="o">.</span><span class="n">reset_matrix</span><span class="p">()</span>
        <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">numrows</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">numcols</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>   <span class="c1"># out of range</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="n">_interpd_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span><span class="p">])</span>

        <span class="n">im</span><span class="o">.</span><span class="n">set_resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resample</span><span class="p">)</span>

        <span class="c1"># the viewport translation</span>
        <span class="k">if</span> <span class="n">dxintv</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">tx</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="o">-</span><span class="n">transformed_viewLim</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">dxintv</span> <span class="o">*</span> <span class="n">numcols</span>
        <span class="k">if</span> <span class="n">dyintv</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">ty</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ty</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span><span class="o">-</span><span class="n">transformed_viewLim</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="n">dyintv</span> <span class="o">*</span> <span class="n">numrows</span>

        <span class="n">im</span><span class="o">.</span><span class="n">apply_translation</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>

        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">widthDisplay</span> <span class="o">=</span> <span class="p">((</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">magnification</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span>
                        <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="n">magnification</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
        <span class="n">heightDisplay</span> <span class="o">=</span> <span class="p">((</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">magnification</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span>
                         <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">magnification</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>

        <span class="c1"># resize viewport to display</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">widthDisplay</span> <span class="o">/</span> <span class="n">numcols</span>
        <span class="n">ry</span> <span class="o">=</span> <span class="n">heightDisplay</span> <span class="o">/</span> <span class="n">numrows</span>
        <span class="n">im</span><span class="o">.</span><span class="n">apply_scaling</span><span class="p">(</span><span class="n">rx</span><span class="o">*</span><span class="n">sx</span><span class="p">,</span> <span class="n">ry</span><span class="o">*</span><span class="n">sy</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">widthDisplay</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">heightDisplay</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span>
                  <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filternorm</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">im</span></div>

    <span class="k">def</span> <span class="nf">_check_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return True if the image is better to be drawn unsampled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interpolation</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">option_scale_image</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The backend (</span><span class="si">%s</span><span class="s2">) does not support &quot;</span>
                              <span class="s2">&quot;interpolation=&#39;none&#39;. The image will be &quot;</span>
                              <span class="s2">&quot;interpolated with &#39;nearest` &quot;</span>
                              <span class="s2">&quot;mode.&quot;</span> <span class="o">%</span> <span class="n">renderer</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="AxesImage.set_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.set_extent.html#matplotlib.figure.AxesImage.set_extent">[docs]</a>    <span class="k">def</span> <span class="nf">set_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extent is data axes (left, right, bottom, top) for making image plots</span>

<span class="sd">        This updates ax.dataLim, and, if autoscaling, sets viewLim</span>
<span class="sd">        to tightly fit the image, regardless of dataLim.  Autoscaling</span>
<span class="sd">        state is not changed, so following this with ax.autoscale_view</span>
<span class="sd">        will redo the autoscaling in accord with dataLim.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="o">=</span> <span class="n">extent</span>

        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">extent</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">update_datalim</span><span class="p">(</span><span class="n">corners</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_autoscaleXon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_autoscaleYon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="AxesImage.get_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.get_extent.html#matplotlib.figure.AxesImage.get_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the image extent: left, right, bottom, top&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extent</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
            <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="n">sz</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">numcols</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">numrows</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">numcols</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">numrows</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="AxesImage.get_cursor_data"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.AxesImage.get_cursor_data.html#matplotlib.figure.AxesImage.get_cursor_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_cursor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the cursor data for a given event&quot;&quot;&quot;</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
        <span class="n">data_extent</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Bbox</span><span class="p">([[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">xmin</span><span class="p">],</span> <span class="p">[</span><span class="n">ymax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">]])</span>
        <span class="n">array_extent</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Bbox</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">BboxTransform</span><span class="p">(</span><span class="n">boxin</span><span class="o">=</span><span class="n">data_extent</span><span class="p">,</span>
                                          <span class="n">boxout</span><span class="o">=</span><span class="n">array_extent</span><span class="p">)</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_point</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="c1"># Clip the coordinates at array bounds</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="NonUniformImage"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.html#matplotlib.figure.NonUniformImage">[docs]</a><span class="k">class</span> <span class="nc">NonUniformImage</span><span class="p">(</span><span class="n">AxesImage</span><span class="p">):</span>
<div class="viewcode-block" id="NonUniformImage.__init__"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.__init__.html#matplotlib.figure.NonUniformImage.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        kwargs are identical to those for AxesImage, except</span>
<span class="sd">        that &#39;interpolation&#39; defaults to &#39;nearest&#39;, and &#39;bilinear&#39;</span>
<span class="sd">        is the only alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">interp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;interpolation&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">AxesImage</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="n">interp</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_unsampled_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return False. Do not use unsampled image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="NonUniformImage.make_image"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.make_image.html#matplotlib.figure.NonUniformImage.make_image">[docs]</a>    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_gray</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
                <span class="n">B</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span>
                <span class="n">B</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">B</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">v_width</span><span class="p">,</span> <span class="n">v_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">*=</span> <span class="n">magnification</span>
        <span class="n">height</span> <span class="o">*=</span> <span class="n">magnification</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span>
                           <span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
                           <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="o">+</span><span class="n">v_width</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">v_height</span><span class="p">),</span>
                           <span class="n">_interpd_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span><span class="p">])</span>

        <span class="n">fc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_bg</span><span class="p">(</span><span class="o">*</span><span class="n">bg</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span>
        <span class="k">return</span> <span class="n">im</span></div>

<div class="viewcode-block" id="NonUniformImage.set_data"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_data.html#matplotlib.figure.NonUniformImage.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the grid for the pixel centers, and the pixel values.</span>

<span class="sd">          *x* and *y* are 1-D ndarrays of lengths N and M, respectively,</span>
<span class="sd">             specifying pixel centers</span>

<span class="sd">          *A* is an (M,N) ndarray or masked array of values to be</span>
<span class="sd">            colormapped, or a (M,N,3) RGB array, or a (M,N,4) RGBA</span>
<span class="sd">            array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">safe_masked_invalid</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span>\
           <span class="ow">or</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Axes don&#39;t match array shape&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only plot 2D or 3D data&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;3D arrays must have three (RGB) &quot;</span>
                            <span class="s2">&quot;or four (RGBA) color components&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">A</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># I am adding this in accor with _AxesImageBase.set_data --</span>
        <span class="c1"># examples/pylab_examples/image_nonuniform.py was breaking on</span>
        <span class="c1"># the call to _get_unsampled_image when the oldxslice attr was</span>
        <span class="c1"># accessed - JDH 3/3/2010</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldxslice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldyslice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NonUniformImage.set_array"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_array.html#matplotlib.figure.NonUniformImage.set_array">[docs]</a>    <span class="k">def</span> <span class="nf">set_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Method not supported&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="NonUniformImage.set_interpolation"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_interpolation.html#matplotlib.figure.NonUniformImage.set_interpolation">[docs]</a>    <span class="k">def</span> <span class="nf">set_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;bilinear&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Only nearest neighbor and &#39;</span>
                                      <span class="s1">&#39;bilinear interpolations are supported&#39;</span><span class="p">)</span>
        <span class="n">AxesImage</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="NonUniformImage.get_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.get_extent.html#matplotlib.figure.NonUniformImage.get_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Must set data first&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="NonUniformImage.set_filternorm"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_filternorm.html#matplotlib.figure.NonUniformImage.set_filternorm">[docs]</a>    <span class="k">def</span> <span class="nf">set_filternorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="NonUniformImage.set_filterrad"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_filterrad.html#matplotlib.figure.NonUniformImage.set_filterrad">[docs]</a>    <span class="k">def</span> <span class="nf">set_filterrad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="NonUniformImage.set_norm"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_norm.html#matplotlib.figure.NonUniformImage.set_norm">[docs]</a>    <span class="k">def</span> <span class="nf">set_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot change colors after loading data&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NonUniformImage</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_norm</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span></div>

<div class="viewcode-block" id="NonUniformImage.set_cmap"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.NonUniformImage.set_cmap.html#matplotlib.figure.NonUniformImage.set_cmap">[docs]</a>    <span class="k">def</span> <span class="nf">set_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot change colors after loading data&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NonUniformImage</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PcolorImage"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.html#matplotlib.figure.PcolorImage">[docs]</a><span class="k">class</span> <span class="nc">PcolorImage</span><span class="p">(</span><span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a pcolor-style plot with an irregular rectangular grid.</span>

<span class="sd">    This uses a variation of the original irregular image code,</span>
<span class="sd">    and it is used by pcolorfast for the corresponding grid type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="PcolorImage.__init__"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.__init__.html#matplotlib.figure.PcolorImage.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                 <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        cmap defaults to its rc setting</span>

<span class="sd">        cmap is a colors.Colormap instance</span>
<span class="sd">        norm is a colors.Normalize instance to map luminance to 0-1</span>

<span class="sd">        Additional kwargs are matplotlib.artist properties</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># There is little point in caching the image itself because</span>
        <span class="c1"># it needs to be remade if the bbox or viewlim change,</span>
        <span class="c1"># so caching does help with zoom/pan/resize.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span></div>

<div class="viewcode-block" id="PcolorImage.make_image"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.make_image.html#matplotlib.figure.PcolorImage.make_image">[docs]</a>    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bg</span><span class="p">)</span><span class="o">*</span><span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="c1"># The extra cast-to-int is only needed for python2</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">magnification</span><span class="p">))</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">height</span> <span class="o">*</span> <span class="n">magnification</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="n">A</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_gray</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span>
        <span class="n">vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">viewLim</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">pcolor2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span>
                            <span class="n">height</span><span class="p">,</span>
                            <span class="n">width</span><span class="p">,</span>
                            <span class="p">(</span><span class="n">vl</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">vl</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">vl</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">vl</span><span class="o">.</span><span class="n">y1</span><span class="p">),</span>
                            <span class="n">bg</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span>
        <span class="k">return</span> <span class="n">im</span></div>

<div class="viewcode-block" id="PcolorImage.changed"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.changed.html#matplotlib.figure.PcolorImage.changed">[docs]</a>    <span class="k">def</span> <span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">renderer</span><span class="o">.</span><span class="n">get_image_magnification</span><span class="p">())</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_clip_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">frozen</span><span class="p">())</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clip_path</span><span class="p">())</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">draw_image</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span>
                            <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span><span class="p">),</span>
                            <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span><span class="p">),</span>
                            <span class="n">im</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="PcolorImage.set_data"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.set_data.html#matplotlib.figure.PcolorImage.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">safe_masked_invalid</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axes don&#39;t match array shape&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A must be 2D or 3D&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">A</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">and</span>
                        <span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;3D arrays must have RGB or RGBA as last dim&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ax</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ay</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PcolorImage.set_array"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.set_array.html#matplotlib.figure.PcolorImage.set_array">[docs]</a>    <span class="k">def</span> <span class="nf">set_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Method not supported&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PcolorImage.set_alpha"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.PcolorImage.set_alpha.html#matplotlib.figure.PcolorImage.set_alpha">[docs]</a>    <span class="k">def</span> <span class="nf">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the alpha value used for blending - not supported on</span>
<span class="sd">        all backends</span>

<span class="sd">        ACCEPTS: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">[</span><span class="s1">&#39;array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="FigureImage"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.html#matplotlib.figure.FigureImage">[docs]</a><span class="k">class</span> <span class="nc">FigureImage</span><span class="p">(</span><span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">):</span>
    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="FigureImage.__init__"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.__init__.html#matplotlib.figure.FigureImage.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">offsetx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">offsety</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        cmap is a colors.Colormap instance</span>
<span class="sd">        norm is a colors.Normalize instance to map luminance to 0-1</span>

<span class="sd">        kwargs are an optional list of Artist keyword args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">martist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.origin&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ox</span> <span class="o">=</span> <span class="n">offsetx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oy</span> <span class="o">=</span> <span class="n">offsety</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnification</span> <span class="o">=</span> <span class="mf">1.0</span></div>

<div class="viewcode-block" id="FigureImage.contains"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.contains.html#matplotlib.figure.FigureImage.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test whether the mouse event occured within the image.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">)</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span>

        <span class="k">if</span> <span class="n">xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="p">((</span><span class="n">xdata</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xdata</span> <span class="o">&lt;=</span> <span class="n">xmax</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="p">(</span><span class="n">ydata</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ydata</span> <span class="o">&lt;=</span> <span class="n">ymax</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="FigureImage.get_size"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.get_size.html#matplotlib.figure.FigureImage.get_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the numrows, numcols of the input image&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="FigureImage.get_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.get_extent.html#matplotlib.figure.FigureImage.get_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the image extent: left, right, bottom, top&quot;&quot;&quot;</span>
        <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ox</span><span class="p">,</span> <span class="n">numcols</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ox</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oy</span><span class="p">,</span> <span class="n">numrows</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oy</span><span class="p">)</span></div>

<div class="viewcode-block" id="FigureImage.set_data"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.set_data.html#matplotlib.figure.FigureImage.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the image array.&quot;&quot;&quot;</span>
        <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cbook</span><span class="o">.</span><span class="n">safe_masked_invalid</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FigureImage.set_array"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.set_array.html#matplotlib.figure.FigureImage.set_array">[docs]</a>    <span class="k">def</span> <span class="nf">set_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deprecated; use set_data for consistency with other image types.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></div>

<div class="viewcode-block" id="FigureImage.make_image"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.make_image.html#matplotlib.figure.FigureImage.make_image">[docs]</a>    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnification</span> <span class="o">=</span> <span class="n">magnification</span>
        <span class="c1"># if magnification is not one, we need to resize</span>
        <span class="n">ismag</span> <span class="o">=</span> <span class="n">magnification</span> <span class="o">!=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ismag</span><span class="p">:</span>
            <span class="n">isoutput</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">isoutput</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">frombyte</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">isoutput</span><span class="p">)</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_bg</span><span class="p">(</span><span class="o">*</span><span class="n">mcolors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;gray&quot;</span> <span class="ow">and</span>
                           <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ismag</span><span class="p">:</span>
            <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
            <span class="n">numrows</span> <span class="o">*=</span> <span class="n">magnification</span>
            <span class="n">numcols</span> <span class="o">*=</span> <span class="n">magnification</span>
            <span class="n">im</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="n">_image</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">)</span>
            <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">numcols</span><span class="p">,</span> <span class="n">numrows</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">im</span></div>

    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="c1"># todo: we should be able to do some cacheing here</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">renderer</span><span class="o">.</span><span class="n">get_image_magnification</span><span class="p">())</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_clip_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clip_path</span><span class="p">())</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">draw_image</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ox</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oy</span><span class="p">),</span> <span class="n">im</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="FigureImage.write_png"><a class="viewcode-back" href="../../generated/generated/matplotlib.image.FigureImage.write_png.html#matplotlib.figure.FigureImage.write_png">[docs]</a>    <span class="k">def</span> <span class="nf">write_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the image to png file with fname&quot;&quot;&quot;</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">()</span>
        <span class="n">_png</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BboxImage"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.html#matplotlib.figure.BboxImage">[docs]</a><span class="k">class</span> <span class="nc">BboxImage</span><span class="p">(</span><span class="n">_AxesImageBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Image class whose size is determined by the given bbox.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="BboxImage.__init__"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.__init__.html#matplotlib.figure.BboxImage.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">filternorm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">filterrad</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                 <span class="n">resample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">interp_at_native</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        cmap is a colors.Colormap instance</span>
<span class="sd">        norm is a colors.Normalize instance to map luminance to 0-1</span>

<span class="sd">        interp_at_native is a flag that determines whether or not</span>
<span class="sd">        interpolation should still be applied when the image is</span>
<span class="sd">        displayed at its native resolution.  A common use case for this</span>
<span class="sd">        is when displaying an image for annotational purposes; it is</span>
<span class="sd">        treated similarly to Photoshop (interpolation is only used when</span>
<span class="sd">        displaying the image at non-native resolutions).</span>


<span class="sd">        kwargs are an optional list of Artist keyword args</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_AxesImageBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
                                <span class="n">filternorm</span><span class="o">=</span><span class="n">filternorm</span><span class="p">,</span>
                                <span class="n">filterrad</span><span class="o">=</span><span class="n">filterrad</span><span class="p">,</span>
                                <span class="n">resample</span><span class="o">=</span><span class="n">resample</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwargs</span>
                                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interp_at_native</span> <span class="o">=</span> <span class="n">interp_at_native</span></div>

<div class="viewcode-block" id="BboxImage.get_window_extent"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.get_window_extent.html#matplotlib.figure.BboxImage.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">_cachedRenderer</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>
        <span class="k">elif</span> <span class="n">six</span><span class="o">.</span><span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;unknown type of bbox&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BboxImage.contains"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.contains.html#matplotlib.figure.BboxImage.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test whether the mouse event occured within the image.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>  <span class="c1"># or self.get_figure()._renderer is None:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="BboxImage.get_size"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.get_size.html#matplotlib.figure.BboxImage.get_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the numrows, numcols of the input image&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image array&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="BboxImage.make_image"><a class="viewcode-back" href="../../generated/generated/matplotlib.offsetbox.BboxImage.make_image.html#matplotlib.figure.BboxImage.make_image">[docs]</a>    <span class="k">def</span> <span class="nf">make_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must first set the image &#39;</span>
                               <span class="s1">&#39;array or the image attribute&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">frombyte</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span> <span class="o">=</span> <span class="n">x</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgbacache</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">_image</span><span class="o">.</span><span class="n">frombyte</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_gray</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">im</span><span class="o">.</span><span class="n">is_grayscale</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span> <span class="o">=</span> <span class="n">im</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imcache</span>

        <span class="c1"># image input dimensions</span>
        <span class="n">im</span><span class="o">.</span><span class="n">reset_matrix</span><span class="p">()</span>

        <span class="n">im</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="n">_interpd_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span><span class="p">])</span>

        <span class="n">im</span><span class="o">.</span><span class="n">set_resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resample</span><span class="p">)</span>

        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span><span class="o">.</span><span class="n">extents</span>  <span class="c1"># bbox.extents</span>
        <span class="n">widthDisplay</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
        <span class="n">heightDisplay</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="n">widthDisplay</span> <span class="o">*=</span> <span class="n">magnification</span>
        <span class="n">heightDisplay</span> <span class="o">*=</span> <span class="n">magnification</span>

        <span class="n">numrows</span><span class="p">,</span> <span class="n">numcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp_at_native</span> <span class="ow">and</span>
                <span class="n">widthDisplay</span> <span class="o">==</span> <span class="n">numcols</span> <span class="ow">and</span> <span class="n">heightDisplay</span> <span class="o">==</span> <span class="n">numrows</span><span class="p">):</span>
            <span class="n">im</span><span class="o">.</span><span class="n">set_interpolation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># resize viewport to display</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">widthDisplay</span> <span class="o">/</span> <span class="n">numcols</span>
        <span class="n">ry</span> <span class="o">=</span> <span class="n">heightDisplay</span> <span class="o">/</span> <span class="n">numrows</span>
        <span class="n">im</span><span class="o">.</span><span class="n">apply_scaling</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">widthDisplay</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">heightDisplay</span><span class="p">),</span>
                  <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filternorm</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filterrad</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">im</span></div>

    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="c1"># todo: we should be able to do some cacheing here</span>
        <span class="n">image_mag</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">get_image_magnification</span><span class="p">()</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">image_mag</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_gc_clip</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>

        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">draw_image</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">im</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="imread"><a class="viewcode-back" href="../../generated/matplotlib.image.imread.html#matplotlib.figure.imread">[docs]</a><span class="k">def</span> <span class="nf">imread</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read an image from a file into an array.</span>

<span class="sd">    *fname* may be a string path, a valid URL, or a Python</span>
<span class="sd">    file-like object.  If using a file object, it must be opened in binary</span>
<span class="sd">    mode.</span>

<span class="sd">    If *format* is provided, will try to read file of that type,</span>
<span class="sd">    otherwise the format is deduced from the filename.  If nothing can</span>
<span class="sd">    be deduced, PNG is tried.</span>

<span class="sd">    Return value is a :class:`numpy.array`.  For grayscale images, the</span>
<span class="sd">    return array is MxN.  For RGB images, the return value is MxNx3.</span>
<span class="sd">    For RGBA images the return value is MxNx4.</span>

<span class="sd">    matplotlib can only read PNGs natively, but if `PIL</span>
<span class="sd">    &lt;http://www.pythonware.com/products/pil/&gt;`_ is installed, it will</span>
<span class="sd">    use it to load the image and return an array (if possible) which</span>
<span class="sd">    can be used with :func:`~matplotlib.pyplot.imshow`. Note, URL strings</span>
<span class="sd">    may not be compatible with PIL. Check the PIL documentation for more</span>
<span class="sd">    information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">pilread</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;try to load the image with PIL or return None&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pil_to_array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="n">handlers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;png&#39;</span><span class="p">:</span> <span class="n">_png</span><span class="o">.</span><span class="n">read_png</span><span class="p">,</span> <span class="p">}</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_string_like</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="c1"># If the string is a URL, assume png</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">scheme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
            <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="nb">format</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">handlers</span><span class="p">:</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">pilread</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only know how to handle extensions: </span><span class="si">%s</span><span class="s1">; &#39;</span>
                             <span class="s1">&#39;with Pillow installed matplotlib can handle &#39;</span>
                             <span class="s1">&#39;more images&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">handlers</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">im</span>

    <span class="n">handler</span> <span class="o">=</span> <span class="n">handlers</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>

    <span class="c1"># To handle Unicode filenames, we pass a file object to the PNG</span>
    <span class="c1"># reader extension, since Python handles them quite well, but it&#39;s</span>
    <span class="c1"># tricky in C.</span>
    <span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_string_like</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="c1"># If fname is a URL, download the data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">scheme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">urlopen</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">handler</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">handler</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="imsave"><a class="viewcode-back" href="../../generated/matplotlib.image.imsave.html#matplotlib.figure.imsave">[docs]</a><span class="k">def</span> <span class="nf">imsave</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save an array as in image file.</span>

<span class="sd">    The output formats available depend on the backend being used.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      *fname*:</span>
<span class="sd">        A string containing a path to a filename, or a Python file-like object.</span>
<span class="sd">        If *format* is *None* and *fname* is a string, the output</span>
<span class="sd">        format is deduced from the extension of the filename.</span>
<span class="sd">      *arr*:</span>
<span class="sd">        An MxN (luminance), MxNx3 (RGB) or MxNx4 (RGBA) array.</span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">      *vmin*/*vmax*: [ None | scalar ]</span>
<span class="sd">        *vmin* and *vmax* set the color scaling for the image by fixing the</span>
<span class="sd">        values that map to the colormap color limits. If either *vmin*</span>
<span class="sd">        or *vmax* is None, that limit is determined from the *arr*</span>
<span class="sd">        min/max value.</span>
<span class="sd">      *cmap*:</span>
<span class="sd">        cmap is a colors.Colormap instance, e.g., cm.jet.</span>
<span class="sd">        If None, default to the rc image.cmap value.</span>
<span class="sd">      *format*:</span>
<span class="sd">        One of the file extensions supported by the active</span>
<span class="sd">        backend.  Most backends support png, pdf, ps, eps and svg.</span>
<span class="sd">      *origin*</span>
<span class="sd">        [ &#39;upper&#39; | &#39;lower&#39; ] Indicates where the [0,0] index of</span>
<span class="sd">        the array is in the upper left or lower left corner of</span>
<span class="sd">        the axes. Defaults to the rc image.origin value.</span>
<span class="sd">      *dpi*</span>
<span class="sd">        The DPI to store in the metadata of the file.  This does not affect the</span>
<span class="sd">        resolution of the output image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_agg</span> <span class="k">import</span> <span class="n">FigureCanvasAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
    <span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">figimage</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
                      <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="pil_to_array"><a class="viewcode-back" href="../../generated/matplotlib.image.pil_to_array.html#matplotlib.figure.pil_to_array">[docs]</a><span class="k">def</span> <span class="nf">pil_to_array</span><span class="p">(</span><span class="n">pilImage</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a PIL image and return it as a numpy array.  For grayscale</span>
<span class="sd">    images, the return array is MxN.  For RGB images, the return value</span>
<span class="sd">    is MxNx3.  For RGBA images the return value is MxNx4</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a 1D array of dtype.&quot;&quot;&quot;</span>
        <span class="c1"># Pillow wants us to use &quot;tobytes&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;tobytes&#39;</span><span class="p">):</span>
            <span class="n">x_str</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_str</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">x_str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">if</span> <span class="n">pilImage</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="s1">&#39;RGBX&#39;</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">pilImage</span>  <span class="c1"># no need to convert images</span>
    <span class="k">elif</span> <span class="n">pilImage</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">pilImage</span>  <span class="c1"># no need to luminance images</span>
        <span class="c1"># return MxN luminance array</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">elif</span> <span class="n">pilImage</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;RGB&#39;</span><span class="p">:</span>
        <span class="c1"># return MxNx3 RGB array</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">pilImage</span>  <span class="c1"># no need to RGB images</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">elif</span> <span class="n">pilImage</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;I;16&#39;</span><span class="p">):</span>
        <span class="c1"># return MxN luminance array of uint16</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">pilImage</span>
        <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;&gt;u2&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;&lt;u2&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;=u2&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># try to convert to an rgba image</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">pilImage</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unknown image mode&#39;</span><span class="p">)</span>

    <span class="c1"># return MxNx4 RGBA array</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">toarray</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span>
    <span class="k">return</span> <span class="n">x</span></div>


<div class="viewcode-block" id="thumbnail"><a class="viewcode-back" href="../../generated/matplotlib.image.thumbnail.html#matplotlib.figure.thumbnail">[docs]</a><span class="k">def</span> <span class="nf">thumbnail</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">thumbfile</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span>
              <span class="n">preview</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    make a thumbnail of image in *infile* with output filename</span>
<span class="sd">    *thumbfile*.</span>

<span class="sd">      *infile* the image file -- must be PNG or Pillow-readable if you</span>
<span class="sd">         have `Pillow &lt;http://python-pillow.github.io/&gt;`_ installed</span>

<span class="sd">      *thumbfile*</span>
<span class="sd">        the thumbnail filename</span>

<span class="sd">      *scale*</span>
<span class="sd">        the scale factor for the thumbnail</span>

<span class="sd">      *interpolation*</span>
<span class="sd">        the interpolation scheme used in the resampling</span>


<span class="sd">      *preview*</span>
<span class="sd">        if True, the default backend (presumably a user interface</span>
<span class="sd">        backend) will be used which will cause a figure to be raised</span>
<span class="sd">        if :func:`~matplotlib.pyplot.show` is called.  If it is False,</span>
<span class="sd">        a pure image backend will be used depending on the extension,</span>
<span class="sd">        &#39;png&#39;-&gt;FigureCanvasAgg, &#39;pdf&#39;-&gt;FigureCanvasPdf,</span>
<span class="sd">        &#39;svg&#39;-&gt;FigureCanvasSVG</span>


<span class="sd">    See examples/misc/image_thumbnail.py.</span>

<span class="sd">    .. htmlonly::</span>

<span class="sd">        :ref:`misc-image_thumbnail`</span>

<span class="sd">    Return value is the figure instance containing the thumbnail</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basedir</span><span class="p">,</span> <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="n">baseout</span><span class="p">,</span> <span class="n">extout</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">thumbfile</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># this doesn&#39;t really matter, it will cancel in the end, but we</span>
    <span class="c1"># need it for the mpl API</span>
    <span class="n">dpi</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">height</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">/</span><span class="n">dpi</span><span class="o">*</span><span class="n">scale</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">/</span><span class="n">dpi</span><span class="o">*</span><span class="n">scale</span>

    <span class="n">extension</span> <span class="o">=</span> <span class="n">extout</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">preview</span><span class="p">:</span>
        <span class="c1"># let the UI backend do everything</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;.png&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_agg</span> \
                <span class="kn">import</span> <span class="nn">FigureCanvasAgg</span> <span class="k">as</span> <span class="nn">FigureCanvas</span>
        <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> \
                <span class="kn">import</span> <span class="nn">FigureCanvasPdf</span> <span class="k">as</span> <span class="nn">FigureCanvas</span>
        <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;.svg&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_svg</span> \
                <span class="kn">import</span> <span class="nn">FigureCanvasSVG</span> <span class="k">as</span> <span class="nn">FigureCanvas</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only handle &quot;</span>
                             <span class="s2">&quot;extensions &#39;png&#39;, &#39;svg&#39; or &#39;pdf&#39;&quot;</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                      <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

    <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">thumbfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>